if("undefined"==typeof table_2){function t(t){return function e(a,i){var d,n;d=[],n=RegExp(a,"i"),$.each(t,function(t,e){n.test(e)&&d.push(e)}),i(d)}}function e(t,e){navigator.clipboard.writeText(t),$(e).after('<span class="text-danger" style="margin-left: 5px; font-size: 10px;">Copied!</span>'),setTimeout(function(){$(e).next("span").remove()},1500)}function a(t,e,a,i,d,n,l){let s=$("#linkDesModal .modal-body");s.empty(),s.addClass("row").addClass("text-center");let o=$("<h4></h4>").text(l).addClass("text-center text-danger"),r=$("<h5></h5>").text(e.product_template_width+"x"+e.product_template_height).addClass("text-center");s.append(o),s.append(r);let c;if(1===t.length?c="col-12 mb-3":t.length%3==0?c="col-md-4 mb-3":(t.length,c="col-md-3 mb-3"),a?t.forEach(function(t){let e;if(t.link.toLowerCase().endsWith(".pdf")){e=$("<div></div>");let a=$("<div></div>").addClass("pdf-embed-container"),i=$("<embed>").attr("src",t.link).attr("type","application/pdf").addClass("pdf-embed");a.append(i),e.append(a)}else{e=$("<div></div>").addClass(c);let d=$("<img>").attr("src",t.link).addClass("img-fluid modal-image").css("box-shadow","0 2px 20px 0 rgba(67,89,113,.45)"),n=$("<small></small>").text(t.width+"x"+t.height+" px").addClass("text-muted"),l=$("<small></small>").text(t.width_mm+"x"+t.height_mm+" mm").addClass("text-muted"),o=$("<small></small>").text(t.width_inch+"x"+t.height_inch+" inch").addClass("text-muted"),r=t.link.split("/").pop(),p=$("<small></small>").text(r).addClass("text-muted"),u=$('<a target="_blank"></a>').attr({href:t.link,download:r}).addClass("download-link").append(d);e.append(u).append("<hr>").append(n),e.append(u).append(l).append("<br>").append(o).append(p).append("<hr>")}s.append(e)}):t.forEach(function(t){let e;if(t.link.toLowerCase().endsWith(".pdf")){e=$("<div></div>");let a=$("<div></div>").addClass("pdf-embed-container"),i=$("<embed>").attr("src",t.link).attr("type","application/pdf").addClass("pdf-embed");a.append(i),e.append(a)}else{e=$("<div></div>").addClass(c);let d=$("<img>").attr("src",t.link).addClass("img-fluid modal-image").css("box-shadow","0 2px 20px 0 rgba(67,89,113,.45)"),n=t.link.split("/").pop(),l=$("<small></small>").text(t.width_mm+"x"+t.height_mm+" mm").addClass("text-muted"),o=$("<small></small>").text(n).addClass("text-muted"),r=$('<a target="_blank"></a>').attr({href:t.link,download:n}).addClass("download-link").append(d);e.append(r).append("<hr>").append(l),e.append(r).append(o).append("<br>").append("<hr>")}s.append(e)}),n){let p=`
            <div class="text-center mt-3">
                <button type="button" class="btn btn-primary" data-order-id="${a}" data-product-id="${i}" data-lineitem-id="${d}" id="approve">Approve</button>
                <button type="button" class="btn btn-danger" data-order-id="${a}" data-product-id="${i}" data-lineitem-id="${d}" id="reject">Reject</button>
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        `;s.append(p)}$("#linkDesModal").modal("show")}function i(t,e,a,i){$.ajax({url:"/api/get_image_info",type:"POST",data:JSON.stringify({link:t,product_type:e}),success:a,error:i})}function d(t){var a=t.data("bs-original-title");console.log(a),e(a,t)}$('[data-toggle="tooltip"]').tooltip(),$(".personalization").on("click",function(){d($(this))}),$(".bx-note").on("click",function(){d($(this))}),$(document).ready(function(){var t=$("#table_products_api").DataTable({select:{style:"multi",selector:'td:first-child input[type="checkbox"]'},aLengthMenu:[[25,50,100,200,-1],[25,50,100,200,"All"]],paging:!1,iDisplayLength:-1,fixedHeader:!0,columnDefs:[{targets:"_all",width:"50px"}],autoWidth:!0});function e(t,e,a,i,d){$.ajax({url:"/api/change_order_status",type:"POST",data:JSON.stringify({orderId:t,productId:e,status:a,note:i}),contentType:"application/json",success:function(t){var e,i;alert(t.message),200===t.status&&(e=d,i=a,e.attr("data-status",i),e.css("background-color",{Ready:"#ecc3fc",Done:"#c5ffd8","Done recently":"#a3ff96",In:"#b3d0ff",Out:"#f8fca3",Cancel:"#ff8c8c",Doing:"#ffdc97","FF Ngoai":"#d6d6d6","Sai design":"#ffbd38","Rejected":"#ffbd38","Design uploaded":"#ffa6e0"}[i]||"transparent"))},error:function(t){alert(t)}})}$(".column-toggle").each(function(){let e=t.column($(this).data("column"));$(this).is(":checked")||e.visible(!1)}),$(".column-toggle").on("change",function(){let e=t.column($(this).data("column")),a=$(".column-filters").data("user"),i=[];$(".column-toggle").each(function(){$(this).is(":checked")&&i.push($(this).data("column"))}),e.visible(!e.visible()),$.ajax({url:"/api/table_column",type:"POST",data:JSON.stringify({column:i,user:a}),success:function(t){},error:function(t){}})}),$("#table_products_api").on("change",".factory-select",function(){var t=$(this).val(),e=$(this).attr("data-order-id"),a=$(this).attr("data-product-id");confirm("Are you sure?")&&$.ajax({url:"/api/change_order_factory",type:"POST",data:JSON.stringify({orderId:e,productId:a,factory:t}),success:function(t){alert(t.message)},error:function(t){alert("Error: ",t)}})}),$("#table_products_api").on("click",".delete-product",function(){var t=$(this).data("id");confirm("Are you sure?")&&$.ajax({url:"/api/delete_product",type:"POST",data:JSON.stringify({id:t,type:"fulfillment"}),success:function(t){alert("Product deleted successfully"),window.location.reload()},error:function(t){alert("Error deleting product")}})}),$("#table_products_api").on("change",".status-select",function(){let t=$(this).val(),a=$(this).data("order-id"),i=$(this).data("product-id"),d=$(this).data("link-des"),n=$(this).data("product-type"),l=$(this).data("sku"),s=$(this).closest(".order-row");confirm("Are you sure?")&&("Sai design"===t?($("#noteModal").modal("show"),$("#noteModal").one("click","#submitNote",function(){let d=$("#noteInput").val();e(a,i,t,d,s),$("#noteInput").val(""),$("#noteModal").modal("hide")})):"Ready"===t&&(null==d||""===d)?(console.log("request to server to get link des"),$.ajax({url:"/api/get_link_des",type:"POST",data:JSON.stringify({sku:l}),success:function(d){if(200===d.status){if(null===d.link_des)$("#uploadOrderDesignReuse").modal("show");else{e(a,i,t,null,s);let o=JSON.stringify(d.link_des).replace(/"/g,"'").replace(/','/g,"', '");html=`
                                        <button type="button"
                                            class="btn btn-sm rounded-pill btn-label-primary download-btn"
                                            data-order-id="${a}" data-product-id="${i}" data-link="${o}"
                                            data-product-type="${n}">
                                            <i class="tf-icons bx bx-download"></i>
                                        </button>
                                    `,s.find(".link-des").html(html)}}else uploadOrderDesignReuse(a,i,l)},error:function(d){console.error(d),e(a,i,t,null,s)}})):e(a,i,t,null,s))}),$("#table_products_api").on("click",".check-btn",function(){let t=$(this),e=t.data("product-id"),d=t.data("order-id"),n=t.data("lineitem-id"),l=t.data("link"),s=t.data("product-type");i(l,s,function(t){let i=t.images,l=t.template;a(i,l,d,e,n,!0,d)},function(t){console.error(t)})}),$("#table_products_api").on("click",".download-btn",function(){let t=$(this),e=t.data("link"),d=t.data("product-type"),n=t.data("order-id");i(e,d,function(t){let e=t.images,i=t.template;a(e,i,null,null,null,!1,n)},function(t){console.error(t)})}),$("#table_products_api").on("click","#archive",function(){let t=$("#table_products_api").find('td:first-child input[type="checkbox"]:checked'),e=[];t.each(function(){let t=$(this).data("lineitem-id");e.push({lineItemId:t})}),$.ajax({url:"/api/archive_order",type:"POST",data:JSON.stringify({selectedValues:e}),success:function(t){alert("Order archived successfully"),window.location.reload()},error:function(t){console.log("error",t)}})}),$("#table_products_api").on("click","#check-all",function(){var t=$(this).prop("checked");$(".order-row input[type='checkbox']").prop("checked",t)}),$("#table_products_api").on("click",".editable",function(){$(this).attr("contentEditable",!0)}),$("#table_products_api").on("click",".editable-select",function(){$(this).find("select").prop("disabled",!1)}),$("#table_products_api").on("blur",".editable",function(){let t=$(this).text(),e=$(this).data("order-id"),a=$(this).data("lineitem-id"),i=$(this).attr("data-field");$.ajax({url:"/api/change_product_field",type:"POST",data:JSON.stringify({orderId:e,lineItemId:a,field:i,value:t}),success:function(t){console.log(t.message)},error:function(t){console.log(t)}})}),$("#table_products_api").on("change",".editable-select select",function(){let t=$(this).val(),e=$(this).closest(".editable-select").data("order-id"),a=$(this).closest(".editable-select").data("lineitem-id"),i=$(this).parent().attr("data-field");$.ajax({url:"/api/change_product_field",type:"POST",data:JSON.stringify({orderId:e,lineItemId:a,field:i,value:t}),success:function(t){if("product_type"===i){let d=$(`.order-row[data-order-id="${e}"][data-lineitem-id="${a}"]`);d.find(".factory-select").val(t.xuong),null!==t.ff_status&&(d.find(".status-select").val(t.ff_status),d.attr("data-status",t.ff_status))}console.log(t.message)},error:function(t){console.log(t)}})})}),$(".copy-id").click(function(){var t=$(this).data("order-id"),e=$(this).data("name"),a=$("<input>");$("body").append(a),a.val(t+" - "+e).select(),document.execCommand("copy"),a.remove();var i=this;$(i).after('<span class="text-danger" style="margin-left: 5px; font-size: 10px;">Copied!</span>'),setTimeout(function(){$(i).next("span").remove()},1500)}),$(".bs-rangepicker-single").each(function(){let t=$(this).data("value"),e={singleDatePicker:!0,opens:"left",autoUpdateInput:!1,locale:{format:"DD/MM/YYYY"}};void 0!==t&&""!==t&&(e.startDate=moment(t,"DD/MM/YYYY"),$(this).val(e.startDate.format("DD/MM/YYYY"))),$(this).daterangepicker(e),$(this).on("apply.daterangepicker",function(t,e){$(this).val(e.startDate.format("DD/MM/YYYY"));let a=$(this).val(),i=$(this).closest(".editable-date").data("order-id"),d=$(this).closest(".editable-date").data("lineitem-id"),n=$(this).closest(".editable-date").data("field");$.ajax({url:"/api/change_product_field",type:"POST",data:JSON.stringify({orderId:i,lineItemId:d,field:n,value:a}),success:function(t){console.log(t.message)},error:function(t){console.log(t)}})}),$(this).on("cancel.daterangepicker",function(t,e){$(this).val("")})}),$("#table_products_api").on("click",".order-history",function(t){t.preventDefault();var e=$(this).data("order-id"),a=$(this).data("lineitem-id");$.ajax({url:"/api/get_order_history",type:"POST",data:JSON.stringify({orderId:e,lineItemId:a}),contentType:"application/json",success:function(t){for(var e="",a=0;a<t.result.length;a++)e+=`
                    <li class="timeline-item timeline-item-transparent">
                        <span class="timeline-point-wrapper"><span class="timeline-point timeline-point-primary"></span></span>
                        <div class="timeline-event">
                            <div class="timeline-header border-bottom mb-3">
                                <h6 class="mb-0">${t.result[a]}</h6>
                            </div>
                        </div>
                    </li>
                    `;console.log(e),$("#historyModal .timeline").html(e),$("#historyModal").modal("show")},error:function(t){console.log("error",t)}})})}